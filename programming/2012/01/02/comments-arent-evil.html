<!DOCTYPE html>
<html xmlns:fb="http://ogp.me/ns/fb#">

  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="author" content="Charles Sprayberry" />
  <meta name="description" content="Why comments aren't necessarily a bad thing along with reasons why you should document your code" />
  <title>comments aren't evil; comment your code -- blog.cspray.net</title>
  <link href="/all.css" type="text/css" rel="stylesheet" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
</head>


  <body>

    <header class="clearfix">
  <h1 class="soft-margin-left pull-left"><a href="/">cspray.net</a><span class="text-muted">::programming</span></h1>
  <ul class="social-icons no-padding no-list-icon clearfix">
    <li class="pull-left"><a class=" social-icon--stack-overflow" href="https://stackoverflow.com/users/746010/cspray"><i class="fa fa-stack-overflow fa-3x"></i></a></li>
    <li class="pull-left"><a class=" social-icon--github" href="https://github.com/cspray"><i class="fa fa-github-square fa-3x"></i></a></li>
    <li class="pull-left"><a class=" social-icon--twitter" href="https://twitter.com/charlesspray"><i class="fa fa-twitter-square fa-3x"></i></a></li>
    <li class="pull-left"><a class=" social-icon--facebook" href="https://www.facebook.com/cspraysworld"><i class="fa fa-facebook-official fa-3x"></i></a></li>
    <li class="pull-left"><a  href="mailto:cspray+blog@gmail.com"><i class="fa fa-envelope-o fa-3x"></i></a></li>
  </ul>
</header>


    <main class="container-fluid">
      <div class="row">
        <section class="col-md-8">
          <h2>comments aren't evil; comment your code</h2>
<p class="text-muted">
  By <strong>Charles Sprayberry</strong> <span title="2012-01-02 00:00:00 -0500">3 years and 7 months ago</span>
  <br />
  Category: <a href="/programming">programming</a>
</p>


<div class="post-content">
  

  

  <ul class="no-list-icon no-padding">
    <li>
        <p><b>Dissenter:</b> Charles, you <i>noob</i>!  Comments <b>are</b> evil.  They can muddy up
        your code, nobody keeps them up to date and they're completely unnecessary.  Write short, concise
        code and you don't need comments!</p>
    </li>
    <li>
        <p><b>Me:</b> You're absolutely right.  Comments can be evil.  But you're taking it too far!
        Not all comments are evil and the innocent are perishing in your genocide!</p>
    </li>
    <li>
        <p><b>Dissenter:</b> Hog-wallop!  All comments are evil.  You have simply not transcended to a
        higher level of programming.</p>
    </li>
    <li>
        <p><b>Me:</b> Perhaps.  But, comments are not inherently evil.  Their <i>intent</i>, the methods
        in which they are utilized, is the true evil!  Comments don't kill code, programmer's kill code.</p>
    </li>
</ul>

<p>That was the envisioned conversation when you saw my bait title and wanted to come tell the new guy
how comments are evil.  Well, now that's out of the way let's get to the post.  Comments, they aren't all
bad.</p>

<h3>stop blaming the comments for how <b>you</b> use them</h3>

<p>Let me start off by saying that I am <b>not</b> encouraging the use of comments everywhere in your
code.  Unnecessary comments really are bad for your codebase.  They're clutter, can be misleading and
are a pain to keep up to date, so nobody keeps them up to date.  And certainly if you're doing something like...</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">1</span> <span class="cp">&lt;?php</span>
<span class="lineno">2</span> 
<span class="lineno">3</span> <span class="nv">$foo</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span>     <span class="c1">// assign &#39;foo&#39; to $foo</span>
<span class="lineno">4</span> <span class="nv">$foo</span> <span class="o">.=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>    <span class="c1">// $foo is now &#39;foobar&#39;</span>
<span class="lineno">5</span> 
<span class="lineno">6</span> <span class="nv">$foo</span> <span class="o">=</span> <span class="nx">someMethod</span><span class="p">(</span><span class="nv">$foo</span><span class="p">);</span>     <span class="c1">// call someMethod() on $foo</span></code></pre></div>

<p>Please, <b>PLEASE</b>, stop doing this.  Please.</p>

<p>That being said this isn't the comments fault.  This is <b>our</b> fault.  We are the ones that
chose to put the comments there and create needless clutter.  Stop blaming the comments and start looking
in the mirror.</p>

<h3>doc-block all the things</h3>

<p>If it is a constant, class member, returns a value, takes a parameter, results in some side effect
or is in some way a major block of code it should be documented.</p>

<blockquote><b>Dissenter:</b> Charles you fool!  You want me to document <i>getters</i>?!  Excuse me while I
ignore you now.</blockquote>

<p>Wait!  Before you go, let me explain.  I don't mean add a description to a <code>getFoo()</code>
method that simply says "return $Foo".  That's just plain silly!  What you can do however is document
the <i>type</i> being returned.  This is highly important with a dynamically typed language, you don't
really ever know what type a variable is until you do some kind of test on it.  Here's an example of a,
<i>gasp</i>, documented getter.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">1</span> <span class="cp">&lt;?php</span>
<span class="lineno">2</span>     <span class="c1">// inside a class somewhere...</span>
<span class="lineno">3</span> 
<span class="lineno">4</span>     <span class="sd">/**</span>
<span class="lineno">5</span> <span class="sd">     * @return A Foo object that stores info about each doohickey</span>
<span class="lineno">6</span> <span class="sd">     */</span>
<span class="lineno">7</span>     <span class="k">public</span> <span class="k">function</span> <span class="nf">getFoo</span><span class="p">()</span> <span class="p">{</span>
<span class="lineno">8</span>         <span class="c1">// some code is here...it returns something</span>
<span class="lineno">9</span>     <span class="p">}</span></code></pre></div>

<p>See, that's not so bad is it?  You're not really adding a lot of clutter but you're giving users of
your API the knowledge that when I call <code>getFoo()</code> I'm gonna get an object, and that object
has the info about the doohickey I need.  In addition a lot of modern IDEs can parse this and return
useful auto-complete and documentation information based on these <a href="http://www.oracle.com/technetwork/java/javase/documentation/index-jsp-135444.html">JavaDoc</a>
style tags.</p>

<h3>finally, comment your cleverness</h3>

<p>Sometimes, regardless of how well we name our variables and how elegant our code is we simply <b>must</b>
have in-line comments.  A lot of articles about writing comments will say this but then they never actually
give a real-life example of a situation where you might need to write an in-line comment.  Well, don't worry,
I'm gonna give you what you need.</p>

<p>Below is a closure I use as an error handler before I can set up a more robust class-based error handler.
It doesn't do much but trap errors and store the information in an array.  Anyway, here's the closure, without
any comments:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno"> 1</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 2</span> <span class="nv">$errors</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span> <span class="nv">$errorCallback</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="nv">$severity</span><span class="p">,</span> <span class="nv">$message</span><span class="p">,</span> <span class="nv">$file</span> <span class="o">=</span> <span class="k">null</span><span class="p">,</span> <span class="nv">$line</span> <span class="o">=</span> <span class="k">null</span><span class="p">,</span> <span class="nv">$context</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="o">&amp;</span><span class="nv">$errors</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span>     <span class="nv">$normalizeSeverity</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$severity</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 7</span>         <span class="nv">$severityMap</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
<span class="lineno"> 8</span>             <span class="k">E_WARNING</span> <span class="o">=&gt;</span> <span class="s1">&#39;E_WARNING&#39;</span><span class="p">,</span>
<span class="lineno"> 9</span>             <span class="nx">E_NOTICE</span> <span class="o">=&gt;</span> <span class="s1">&#39;E_NOTICE&#39;</span><span class="p">,</span>
<span class="lineno">10</span>             <span class="nx">E_USER_ERROR</span> <span class="o">=&gt;</span> <span class="s1">&#39;E_USER_ERROR&#39;</span><span class="p">,</span>
<span class="lineno">11</span>             <span class="nx">E_USER_WARNING</span> <span class="o">=&gt;</span> <span class="s1">&#39;E_USER_WARNING&#39;</span><span class="p">,</span>
<span class="lineno">12</span>             <span class="nx">E_USER_NOTICE</span> <span class="o">=&gt;</span> <span class="s1">&#39;E_USER_NOTICE&#39;</span><span class="p">,</span>
<span class="lineno">13</span>             <span class="nx">E_USER_DEPRECATED</span> <span class="o">=&gt;</span> <span class="s1">&#39;E_USER_DEPRECATED&#39;</span><span class="p">,</span>
<span class="lineno">14</span>             <span class="nx">E_RECOVERABLE_ERROR</span> <span class="o">=&gt;</span> <span class="s1">&#39;E_RECOVERABLE_ERROR&#39;</span><span class="p">,</span>
<span class="lineno">15</span>             <span class="nx">E_DEPRECATED</span> <span class="o">=&gt;</span> <span class="s1">&#39;E_DEPRECATED&#39;</span>
<span class="lineno">16</span>         <span class="p">);</span>
<span class="lineno">17</span>         <span class="k">if</span> <span class="p">(</span><span class="nx">\array_key_exists</span><span class="p">(</span><span class="nv">$severity</span><span class="p">,</span> <span class="nv">$severityMap</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">18</span>             <span class="k">return</span> <span class="nv">$severityMap</span><span class="p">[</span><span class="nv">$severity</span><span class="p">];</span>
<span class="lineno">19</span>         <span class="p">}</span>
<span class="lineno">20</span>         <span class="k">return</span> <span class="s1">&#39;E_UNKOWN_SEVERITY&#39;</span><span class="p">;</span>
<span class="lineno">21</span>     <span class="p">};</span>
<span class="lineno">22</span> 
<span class="lineno">23</span>     <span class="nv">$index</span> <span class="o">=</span> <span class="nx">\count</span><span class="p">(</span><span class="nv">$errors</span><span class="p">);</span>
<span class="lineno">24</span>     <span class="nv">$errors</span><span class="p">[</span><span class="nv">$index</span><span class="p">][</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$normalizeSeverity</span><span class="p">();</span>
<span class="lineno">25</span>     <span class="nv">$errors</span><span class="p">[</span><span class="nv">$index</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$message</span><span class="p">;</span>
<span class="lineno">26</span>     <span class="nv">$errors</span><span class="p">[</span><span class="nv">$index</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span>
<span class="lineno">27</span>     <span class="nv">$errors</span><span class="p">[</span><span class="nv">$index</span><span class="p">][</span><span class="s1">&#39;line&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$line</span><span class="p">;</span>
<span class="lineno">28</span> 
<span class="lineno">29</span>     <span class="nv">$unhandledSeverity</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nx">E_RECOVERABLE_ERROR</span><span class="p">);</span>
<span class="lineno">30</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">\in_array</span><span class="p">(</span><span class="nv">$severity</span><span class="p">,</span> <span class="nv">$unhandledSeverity</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">31</span>         <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">32</span>     <span class="p">}</span>
<span class="lineno">33</span> 
<span class="lineno">34</span> <span class="p">};</span>
<span class="lineno">35</span> 
<span class="lineno">36</span> <span class="nx">\set_error_handler</span><span class="p">(</span><span class="nv">$errorCallback</span><span class="p">);</span></code></pre></div>

<blockquote>This closure is also stored as a <a href="https://gist.github.com/1542873">github gist</a>.  Please
feel free to fork and make changes or improvements.  If you make a really cool improvement let me know!</blockquote>

<p>The closure is pretty simple really.  It takes the appropriate arguments needed to satisfy the
<a href="http://www.php.net/manual/en/function.set-error-handler.php"><code>set_error_handler()</code></a> callback.
It also uses an array-by-reference outside of the closure to store the errors so we can access them later.  I
added a bit of severity normalization so error info doesn't have seemingly random integers in them.  What may be "tricky",
particularly to a new developer on the project, is the last little bit involving the <code>$unhandledSeverity</code>.  What
is that?  Anybody can see that for <code>E_RECOVERABLE_ERROR</code> we're returning false and internal
PHP error handling continues.  But, why?  Let's go ahead and take that out.  I mean its a recoverable
error, right?  So, we should probably be doing something with it.</p>

<p><b>Wrong.</b></p>

<p>That little chunk of code is there for a very specific, very important reason.  Did you know that
if an improper type is passed to a function an <code>E_RECOVERABLE_ERROR</code> is raised?  If we simply
trapped that error we'd allow <b>any</b> data type to be stored where only a specific type should be.  This
certainly doesn't seem like a recoverable error to me.  We need that line of code or else countless
errors will occur later.</p>

<p>Comment it!</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="lineno">1</span> <span class="cp">&lt;?php</span>
<span class="lineno">2</span>     <span class="c1">// ...</span>
<span class="lineno">3</span> 
<span class="lineno">4</span>     <span class="c1">// this is here to return errors on improper type passed as argument</span>
<span class="lineno">5</span>     <span class="nv">$unhandledSeverity</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nx">E_RECOVERABLE_ERROR</span><span class="p">);</span>
<span class="lineno">6</span>     <span class="k">if</span> <span class="p">(</span><span class="nx">\in_array</span><span class="p">(</span><span class="nv">$severity</span><span class="p">,</span> <span class="nv">$unhandledSeverity</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">7</span>         <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">8</span>     <span class="p">}</span>
<span class="lineno">9</span> <span class="p">};</span></code></pre></div>

<p style="margin-top:1em;">I would definitely say that the added "clutter" is far outweighed by the <b>extremely, useful information</b> that
the comment conveys and would be difficult to say in code.  You won't find many in-line comments in my
code but anytime I think something looks a little too clever or isn't <i>perfectly clear</i> as to what
is going on I'll throw a simple comment for explanation.</p>

<h3>wrapping it up</h3>

<p>I hope you look at your code and see where maybe some documentation should be added, or even taken
away.  Remember that comments are available to us for a reason.  Any tool can be utilized effectively
to provide benefit, just as that same tool can be used for evil.</p>

</div>

        </section>

        <aside class="col-md-4">
          <div class="alert alert-warning">
            <p>
              The site is currently undergoing a migration. <strong>Comments are temporarily disabled
              until the migration is complete</strong>. I appreciate the activity from the occiasional
              reader and plan on enabling comments again soon.
            </p>
          </div>
          <p>My name is Charles Sprayberry. I <a href="https://github.com/cspray">write software for the web</a>,
          <a href="https://designbook.com">help your startup raise money</a>, play video games, and train dogs.
          I have a beautiful wife named Dyana.</p>

          <p><a href="/about.html">Learn more about me.</a></p>

          <h3>Categories</h3>

          
            <div>
              
              <h4>programming <span class="badge">20</span></h4>
              <ul class="no-list-icon"><li><a href="/programming/2015/08/02/saying-goodbye-to-sprayfire.html">saying goodbye to SprayFire</a> <p class="text-muted">Posted today</p></li><li><a href="/programming/2014/01/09/you-decided-write-framework-anyway.html">you decided to write a framework anyway</a> <p class="text-muted">Posted 1 year and 6 months ago</p></li><li><a href="/programming/2013/08/21/thoughts-json-oss-license.html">thoughts on JSON and OSS licensing</a> <p class="text-muted">Posted 1 year and 11 months ago</p></li><li><a href="/programming/2013/06/06/why-i-tdd.html">why I TDD</a> <p class="text-muted">Posted 2 years and 1 month ago</p></li><li><a href="/programming/2013/03/05/you-shouldnt-write-framework.html">you shouldn't write a framework</a> <p class="text-muted">Posted 2 years and 5 months ago</p></li><li><a href="/programming/2012/08/13/programming-not-just-writing-code.html">programming is not just writing code</a> <p class="text-muted">Posted 2 years and 11 months ago</p></li><li><a href="/programming/2012/07/07/the-model-layer-and-class.html">the model, a layer and a class</a> <p class="text-muted">Posted 3 years and 3 weeks ago</p></li><li><a href="/programming/2012/06/30/when-why-use-value-objects.html">when and why to use Value Objects</a> <p class="text-muted">Posted 3 years and 1 month ago</p></li><li><a href="/programming/2012/05/13/stop-calling-them-getters-setters.html">stop calling them getters and setters</a> <p class="text-muted">Posted 3 years and 2 months ago</p></li><li><a href="/programming/2012/03/13/spaghetti-triage.html">spaghetti triage</a> <p class="text-muted">Posted 3 years and 4 months ago</p></li><li><a href="/programming/2012/02/13/a-community-gone-mad.html">a community gone mad</a> <p class="text-muted">Posted 3 years and 5 months ago</p></li><li><a href="/programming/2012/02/10/going-from-solo-to-professional.html">going from solo to professional</a> <p class="text-muted">Posted 3 years and 5 months ago</p></li><li><a href="/programming/2012/01/29/DI-and-global-state.html">DI and global state</a> <p class="text-muted">Posted 3 years and 6 months ago</p></li><li><a href="/programming/2012/01/24/why-you-should-use-DI.html">why you should use DI</a> <p class="text-muted">Posted 3 years and 6 months ago</p></li><li><a href="/programming/2012/01/21/you-better-pay-attention-to-details.html">you better pay attention to details</a> <p class="text-muted">Posted 3 years and 6 months ago</p></li><li><a href="/programming/2012/01/17/dog-training-your-code.html">dog training your code</a> <p class="text-muted">Posted 3 years and 6 months ago</p></li><li><a href="/programming/2012/01/06/how-to-be-great-at-x.html">how to be great at $x</a> <p class="text-muted">Posted 3 years and 6 months ago</p></li><li><a href="/programming/2012/01/03/sprayfire-and-mvc-design-pattern.html">SprayFire and MVC design pattern</a> <p class="text-muted">Posted 3 years and 7 months ago</p></li><li><a href="/programming/2012/01/02/comments-arent-evil.html">comments aren't evil; comment your code</a> <p class="text-muted">Posted 3 years and 7 months ago</p></li><li><a href="/programming/2011/12/31/writing-better-commits-with-github.html">writing better commits with github</a> <p class="text-muted">Posted 3 years and 7 months ago</p></li></ul>
            </div>
          
            <div>
              
              <h4>tech-and-society <span class="badge">2</span></h4>
              <ul class="no-list-icon"><li><a href="/tech-and-society/2013/07/25/web-dev-problems.html">Web Development, the problem</a> <p class="text-muted">Posted 2 years and 1 week ago</p></li><li><a href="/tech-and-society/2012/02/06/why-I-quit-school-what-it-would-take-to-stay.html">why I quit school and what it would take to stay</a> <p class="text-muted">Posted 3 years and 5 months ago</p></li></ul>
            </div>
          
        </aside>
      </div>
    </main>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28863236-1']);
      _gaq.push(['_trackPageview']);
      (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
